"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common"],function(e,t,i,n,o){function s(t){t&&t.usrico?o.util.setUserImage(e("#sex_image"),t.usrico):"0"==t.sex?e("#sex_image").attr("src","resources/img/user/user-female.png"):"1"==t.sex&&e("#sex_image").attr("src","resources/img/user/user-female.png")}function a(){o.dao.getSignContent({userId:o.util.getUserId()},function(t){e("#total_point").text(t.totalPoints),e("#sign_list").html(e("#SignItemTempl").tmpl(t.signLogs)),e("#signed_today").text(e.i18n.map.TodayTitle);for(var i=0;i<t.signLogs.length;i++){const n=t.signLogs[i];1==n.isToday&&(0==n.signed?e("#clockin_btn").text(e.i18n.map.ClockinBtn):e("#clockin_btn").text(e.i18n.map.ClockedinBtn))}e("#clockin_btn").unbind("click").click(function(){e(this).text()==e.i18n.map.ClockinBtn&&o.dao.userSign({userId:o.util.getUserId()},function(){e("#clockin_btn").text(e.i18n.map.ClockedinBtn),a(),r()})})})}function r(){e(".loading-my-point").removeClass("hide"),e(".empty-data").addClass("hide"),e("#my_point_list").addClass("hide"),o.dao.getPointList({userId:o.util.getUserId(),curPage:l.curPage},function(t){if(e(".loading-my-point").addClass("hide"),t.totalPoints&&(c=t.totalPoints,e("#total_point").text(c)),t.page&&(l=t.page,u=l.amount%l.pageSize==0?parseInt(l.amount/l.pageSize):parseInt(l.amount/l.pageSize)+1,g(u)),t.logs&&t.logs.length>0){for(var i=t.logs,n=0;n<i.length;n++){var s=i[n];s.time=o.util.formatOrderDateTime(s.time)}e("#my_point_list").html(e("#MyPointTempl").tmpl(i)),e(".empty-data").addClass("hide"),e("#my_point_list").removeClass("hide")}else m()},function(){m()})}function m(){e(".loading-my-point").addClass("hide"),e(".empty-data").removeClass("hide"),e("#my_point_list").addClass("hide")}function g(t){e(function(){var i={bootstrapMajorVersion:1,currentPage:l.curPage,totalPages:t,shouldShowPage:!0,onPageClicked:function(t,n,o,s){l.curPage!==s&&(l.curPage=s,e("html").scrollTop(0),r(),i.currentPage=s,e("#page").bootstrapPaginator(i))},onPageChanged:function(e,t,i){}};e("#page").bootstrapPaginator(i)})}var l={amount:0,curPage:1,pageSize:0},c=0,d="",u="";o.initLoginStatus(function(t){if(t){if(sessionStorage.userInfo){var i=JSON.parse(sessionStorage.userInfo);i.firstName?d=i.firstName+i.lastName:i.email&&(d=i.email),e("#name").text(d),s(i),r(),a()}sessionStorage.commentSwitch&&"1"==sessionStorage.commentSwitch?e("#menu_my_comment").removeClass("hide"):e("#menu_my_comment").addClass("hide"),sessionStorage.messageSwitch&&"1"==sessionStorage.messageSwitch?e("#menu_my_message").removeClass("hide"):e("#menu_my_message").addClass("hide")}else window.location.href="../../../login.html"})});