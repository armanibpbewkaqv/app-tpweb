"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","bootstrapPaginator"],function(t,e,i,a,n,s){function r(){if(t(".pop-content").is(":visible")){t(".pop-content").css("display","none");for(var e=t(".filter-item"),i=0;i<e.length;i++){const a=e[i];t(a).children().eq(1).addClass("icon-hao"),t(a).children().eq(1).removeClass("icon--hao")}}}function o(){t("body").click(function(){r()}),sessionStorage.list_lable_bg&&t(".product-label-item").css("background",sessionStorage.list_lable_bg),sessionStorage.list_lable_fc&&t(".product-label-item").css("color",sessionStorage.list_lable_fc),t("#load_more_btn").unbind("click").click(function(){C.curPage<P&&!y&&(y=!0,C.curPage=C.curPage+1,t("#list_refresh_loading").removeClass("hide"),d())}),t("#sort_btn").unbind("click").click(function(e){e.stopPropagation(),t(this).children().eq(1).hasClass("icon-hao")?(r(),t(this).find(".pop-content").css("display","block"),t(this).children().eq(1).removeClass("icon-hao"),t(this).children().eq(1).addClass("icon--hao")):(t(this).find(".pop-content").css("display","none"),t(this).children().eq(1).addClass("icon-hao"),t(this).children().eq(1).removeClass("icon--hao"))}),t("#sort_btn .filter-attr-item").unbind("click").click(function(){Number(t(this).data().data)!==b&&(t("#sort_btn .filter-attr-item i").removeClass("icon-radio"),t("#sort_btn .filter-attr-item i").addClass("icon-RadioButton"),t(this).find("i").removeClass("icon-RadioButton"),t(this).find("i").addClass("icon-radio"),C.curPage=1,b=Number(t(this).data().data),d())})}function l(){if(n.util.menu&&n.util.menu.length>0){var e=n.util.getAdvSource().u,i=n.util.encodeMenuType(n.util.getUvid());e||(e=n.util.getQueryString("u"));var a="";a=e?"?u="+e+"&uvid="+i:"?uvid="+i;for(var s=n.util.menu.reverse(),r="<li><a id='breadcrumb_home' href='/'>"+t.i18n.map.Home+"</a></li>",o=0;o<s.length;o++){var l=n.util.formatProductName(s[o].menu_name)+"-l-"+n.util.encodeMenuType(s[o].menu_type)+".html"+a;"1"==s[o].supportgp&&(l=n.util.formatProductName(s[o].menu_name)+"-g-"+n.util.encodeMenuType(s[o].menu_type)+"-"+n.util.encodeMenuType(n.util.getUvid())+".html"+a),o==s.length-1?(r=r+"<li class='active'><a href='"+l+"'>"+s[o].menu_name+"</a></li>",t("#product_classify_name").html(s[o].menu_name),document.title=s[o].menu_name):r=r+"<li><a href='"+l+"'>"+s[o].menu_name+"</a></li>"}t(".breadcrumb").html(r),t(".breadcrumb").removeClass("hide")}}function d(e){t("#list_loading").removeClass("hide");var e=u();n.dao.productsbymenuandtag({currencyId:n.util.getLocalCurrency(),productType:x,currentPage:C.curPage,orderby:b,filterObj:JSON.stringify({fiterAttr:e||[],tags:v||[]})},function(e){e&&e.typeDes&&t("#classify_name").html(e.typeDes),e.page?(t("#classify_name").html(t("#classify_name").text()+"("+e.page.amount+")"),C.amount=e.page.amount,C.pageSize=e.page.pageSize,C.curPage=e.page.curPage,P=C.amount%C.pageSize==0?parseInt(C.amount/C.pageSize):parseInt(C.amount/C.pageSize)+1):t("#classify_name").html(t("#classify_name").text()+"(0)");var i=e.products;i&&i.length>0?(p(i),_(i),h(),t("#item_list").show(),t(".empty-data").hide(),t(".page-function-wrap").show()):(t("#item_list").hide(),t(".empty-data").show(),t(".page-function-wrap").hide()),t("#left_filter_wrap .btn-wrap .confirm-btn").text(t.i18n.map.ConfirmBtn+"("+(C.amount?C.amount:0)+")"),t(".sort-wrap").removeClass("invisibility"),t(".loading-mask").addClass("hide"),t("footer").removeClass("invisibility"),y=!1},null,function(){t(".loading-mask").addClass("hide"),t("footer").removeClass("invisibility"),t("#list_loading").addClass("hide"),t("#list_refresh_loading").addClass("hide")})}function c(){n.dao.getMenuAdsCnt({productType:x},function(e){e&&(e.adstxt&&e.adstxt.length>0?(t(".category-adv-wrap").show(),t(".category-adv-wrap").html(e.adstxt)):t(".category-adv-wrap").hide(),k=e.filterObj,m(k.tags),k.fiterAttr&&k.fiterAttr.length>0&&(t("#filter_list").html(t("#filterItemTempl").tmpl(k.fiterAttr)),t("#filter_list .filter-item").unbind("click").click(function(e){e.stopPropagation(),t(this).children().eq(1).hasClass("icon-hao")?(r(),t(this).find(".pop-content").css("display","block"),t(this).children().eq(1).removeClass("icon-hao"),t(this).children().eq(1).addClass("icon--hao")):(t(this).find(".pop-content").css("display","none"),t(this).children().eq(1).addClass("icon-hao"),t(this).children().eq(1).removeClass("icon--hao"))}),t("#filter_list .filter-attr-item").unbind("click").click(function(e){e.stopPropagation(),t(this).find("i").hasClass("icon-fuxuankuang")?(t(this).find("i").removeClass("icon-fuxuankuang"),t(this).find("i").addClass("icon-fuxuankuang1")):(t(this).find("i").addClass("icon-fuxuankuang"),t(this).find("i").removeClass("icon-fuxuankuang1")),r(),C.curPage=1,d()})),t("#sort_btn .filter-attr-item i").eq("0").removeClass("icon-RadioButton"),t("#sort_btn .filter-attr-item i").eq("0").addClass("icon-radio"))})}function u(){var e=[];if(k)for(var i=0;i<k.fiterAttr.length;i++){for(var a={des:k.fiterAttr[i].des,type:k.fiterAttr[i].type,dmList:[]},n=0;n<k.fiterAttr[i].dmList.length;n++){var s=t("#"+k.fiterAttr[i].type+"_"+k.fiterAttr[i].dmList[n].optId);if(s.find("i").hasClass("icon-fuxuankuang1")){var r={optDes:k.fiterAttr[i].dmList[n].optDes,optId:k.fiterAttr[i].dmList[n].optId};a.dmList.push(r)}}a.dmList.length>0&&e.push(a)}return e}function m(e){e&&e.length>0&&(t("#label_list_wrap").html(t("#labelListTempl").tmpl(e)),t("#label_list_wrap").removeClass("hide"),t(".label-item").each(function(){for(var e=0;e<v.length;e++)t(this)[0].id==v[e]&&t(this).addClass("selected")}),t(".label-item").bind("click",function(e){var i=t(this)[0].id;if(t(this).hasClass("selected")){t(this).removeClass("selected");for(var a=0;a<v.length;a++)v[a].tagId==i&&v.splice(a,1)}else t(this).addClass("selected"),v.push({tagDes:t(this).text(),tagId:i});d()}))}function p(e){var i=n.util.getCurrencySymbol(n.util.getLocalCurrency()),a=n.util.getAdvSource().u;a||(a=n.util.getQueryString("u"));var s=n.util.encodeMenuType(n.util.getUvid()),r="";r=a?"?u="+a+"&uvid="+s:"?uvid="+s;for(var l=0;l<e.length;l++){for(var d=e[l],c=0;c<d.display_data.length;c++){var u=d.display_data[c];u.original_price=n.util.formatProductPrice(u.original_price,i),u.current_price=n.util.formatProductPrice(u.current_price,i),u.img_display=n.util.picUrl+u.img_display,u.color_img=n.util.picUrl+u.color_img,u.href=n.util.formatProductName(d.product_name)+"-d-"+n.util.encodeMenuType(d.product_id)+"-"+n.util.encodeMenuType(u.color_id)+".html"+r,u.disCount&&sessionStorage.listOffSwitch&&"1"==sessionStorage.listOffSwitch?u.disCount=u.disCount:u.disCount="",n.util.isMobile()?u.target="_blank":u.target="_self"}d.showColor=sessionStorage.img_block,d.statistic.saled&&(d.sold=t.i18n.map.soldedHint.replace("$number",d.statistic.saled))}if(n.util.isMobile()){1==C.curPage&&t("#item_list").html("");var m=t("#item_list").html();t("#item_list").html(t("#productItemTempl").tmpl(e)),m+=t("#item_list").html(),t("#item_list").html(m)}else t("#item_list").html(t("#productItemTempl").tmpl(e));t("#item_list #new_label").text(t.i18n.map.listNewLabel),o()}function h(){n.util.isMobile()?(t("#top_page").addClass("hide"),g(P)):(t("#top_page").removeClass("hide"),f(P))}function g(e){e>1&&C.curPage<e?(t("#load_more_btn").removeClass("hide"),t("#list_refresh_loading").removeClass("hide")):(t("#load_more_btn").addClass("hide"),t("#list_refresh_loading").addClass("hide"))}function f(e){t("#load_more_btn").addClass("hide"),t("#list_loading").addClass("hide"),t(function(){var i={bootstrapMajorVersion:1,currentPage:C.curPage,totalPages:e,shouldShowPage:!0,onPageClicked:function(e,a,n,s){C.curPage!==s&&(C.curPage=s,t("html").scrollTop(0),d(),i.currentPage=s,"top_page"==e.currentTarget.id?t("#page").bootstrapPaginator(i):t("#top_page").bootstrapPaginator(i))},onPageChanged:function(t,e,i){var a=window.location.href;a.indexOf("/#/")>-1&&(a=a.substring(0,a.indexOf("/#/"))),history.pushState("","",a+"/#/"+i)}};t("#page").bootstrapPaginator(i),t("#top_page").bootstrapPaginator(i)})}function _(e){t("#item_list .color-wrap img").bind("click",function(i){i.stopPropagation();var a=t(this).parent().parent().parent().parent().data().data,n=t(this).data().data,s=e[a].display_data[n];t(this).parent().parent().find("img").removeClass("selected"),t(this).addClass("selected");var r=s.href;t(this).parent().parent().parent().find("a:first").attr("href",r),t(this).parent().parent().parent().find("img:first").attr("src",s.img_display),t(this).parent().parent().parent().find(".product-name").html(s.pcName),t(this).parent().parent().parent().find(".product-ext-name").html(s.pcNameExt),t(this).parent().parent().parent().find(".price-wrap .goods-price").html(s.current_price),t(this).parent().parent().parent().find(".price-wrap .goods-del-price").html(s.original_price)})}t(window).on("popstate",function(){var e=window.location.href;e.indexOf("/#/")>-1?C.curPage=parseInt(e.substring(e.indexOf("/#/")+3)):C.curPage=1,t("html").scrollTop(0),d()}),n.util.getCookie("isFirst")||(n.util.setCookie("isFirst",0),t(".loading-mask").removeClass("hide")),n.initLoginStatus(),n.setLanguageCallback(function(){t("#breadcrumb_home").text(t.i18n.map.Home),t("#sort_method").html(t.i18n.map.SortRecommended)});var b=1,C={amount:0,curPage:1,pageSize:0},v=[],y=!1,P=0,k=null,w=window.location.href,S=n.util.getListParams(w),x=n.util.decodeMenuType(S[0]);w.indexOf("/#/")>-1?C.curPage=parseInt(w.substring(w.indexOf("/#/")+3)):C.curPage=1,n.util.menu=[],n.util.getClassifyNames(x,function(){l()}),n.setCurrencyCodeCallback(function(){c(),d(),sessionStorage.s_fm_bg&&t("#load_more_btn").css("background",sessionStorage.s_fm_bg),sessionStorage.s_fm_fc&&t("#load_more_btn").css("color",sessionStorage.s_fm_fc)})});