"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","star","wall","front"],function(t,e,i,a,r,o,s,n){function l(){t("#detail_tab .tab-item").removeClass("selected"),t("#detail_tab .tab-item").eq(0).addClass("selected"),t("#description").removeClass("hide"),t("#custom_function_wrap").addClass("hide"),t("#shipping_return_desc").addClass("hide"),t("#detail_tab .tab-item").click(function(){t("#detail_tab .tab-item").removeClass("selected"),t(this).addClass("selected");var e=t(this).index();0==e?(t("#description").removeClass("hide"),t("#custom_function_wrap").addClass("hide"),t("#shipping_return_desc").addClass("hide"),t("#detail_tab").hasClass("fixed")&&(document.documentElement.scrollTop=document.body.scrollTop=document.getElementById("description").offsetTop-120)):1==e?(t("#description").addClass("hide"),t("#custom_function_wrap").removeClass("hide"),t("#pic_wall_list_wrap").addClass("hide"),t("#comment_list_wrap").removeClass("hide"),t("#shipping_return_desc").addClass("hide"),t("#detail_tab").hasClass("fixed")&&(document.documentElement.scrollTop=document.body.scrollTop=document.getElementById("custom_function_wrap").offsetTop-120)):2==e?(t("#description").addClass("hide"),t("#custom_function_wrap").removeClass("hide"),t("#comment_list_wrap").addClass("hide"),t("#pic_wall_list_wrap").removeClass("hide"),t("#shipping_return_desc").addClass("hide"),t("#detail_tab").hasClass("fixed")&&(document.documentElement.scrollTop=document.body.scrollTop=document.getElementById("custom_function_wrap").offsetTop-120)):3==e&&(t("#description").addClass("hide"),t("#custom_function_wrap").addClass("hide"),t("#shipping_return_desc").removeClass("hide"),t("#detail_tab").hasClass("fixed")&&(document.documentElement.scrollTop=document.body.scrollTop=document.getElementById("shipping_return_desc").offsetTop-120))})}function d(){t("#play_btn").removeClass("hide"),t("#play_btn").click(function(){if(ht){t("#iframe_loading").removeClass("hide"),t("#video").addClass("hide"),t("#video").attr("src",ht);document.getElementById("video").onload=function(){t("#iframe_loading").addClass("hide"),t("#video").removeClass("hide")}}t("#video_mask").removeClass("hide"),t("#video_mask #close_video_btn").click(function(){t("#video").attr("src",""),t("#video_mask").addClass("hide")})})}function c(){t("#custom_confirm_btn").unbind("click").click(function(){p(2)}),t("#custom_wrap_mask #close_btn, #custom_wrap_mask #custom_cancel_btn").unbind("click").click(function(){y()})}function u(e){var i=[];if(1==e){for(var a=t("#qty_input").val()?Number(t("#qty_input").val()):1,o={userId:r.util.getUserId(),productName:dt.productName,productImage:dt.productImage,productId:dt.productId,productColorId:dt.productColorId,productColor:dt.productColor,productNum:a,attrOpts:[],attrString:""},s=null,n=0;n<lt.color_data[0].dyn_attrs.length;n++){var l={},d=lt.color_data[0].dyn_attrs[n];if(!(t("#"+L(d.attrID)+"_list").find(".selected").length>0))return alert(t.i18n.map.NoAttr+" "+d.attr_name),null;var c=t("#"+L(d.attrID)+"_list").find(".selected").children().eq(0).text(),u=t("#"+L(d.attrID)+"_list").find(".selected").data().data;s=null==s?d.attr_name+": "+c:s+","+d.attr_name+": "+c,l.attrType=d.attrID,l.attrOptId=u,o.attrOpts.push(l)}o.attrString=s,i.push(JSON.parse(JSON.stringify(o)))}else if(2==e)for(var o={userId:r.util.getUserId(),productId:dt.productId,productColorId:dt.productColorId,productNum:1,attrOpts:[{attrType:"",attrOptId:""}]},n=0;n<ut.length;n++){var p=ut[n],m=t("#"+p.optId+"_number_list").val();console.log(m),"11"==m&&((m=t("#"+p.optId+"_number_list").parent().find("input").val())||(m=0)),m>0&&(o.productNum=m,o.attrOpts=[{attrType:p.attrType,attrOptId:p.optId}],i.push(JSON.parse(JSON.stringify(o))))}return i}function p(e){var i=null;if(null==(i=lt.subprds&&lt.subprds.length>0?W():_t?g(e):u(e))||0==i.length)return void y();if(N(),t("#product_name").html(i[0].productName),t("#product_attr").html(i[0].attrString),i[0].productColor&&t("#product_color").html(t.i18n.map.ColorTitle+": "+i[0].productColor),t("#product_image").attr("src",i[0].productImage),i[0].subCarts&&i[0].subCarts.length>0){for(var a=[],o=0;o<i[0].subCarts.length;o++)i[0].subCarts[o].attrOpts.length>0&&a.push(i[0].subCarts[o]);a.length>0&&t("#sub_prd_attr_list").html(t("#subPrdAttrItem").tmpl(a))}r.util.checkIsLogin()?m(i):_(i)}function m(e){r.dao.merge2cart({inputParams:JSON.stringify(e)},function(){x();for(var i=0,a=0;a<e.length;a++){i=e[a].productNum}var r=Number(t("#cart_product_number").text());t("#cart_product_number").text(r+i),t("#mb_cart_product_number").text(r+i),y()},function(t){y(),alert(t.msg)})}function _(e){var i=localStorage.productList;if(i=i?JSON.parse(i):[],0==i.length)i=e;else for(var a=0;a<e.length;a++){for(var r=e[a],o=!1,s=JSON.stringify(r.attrOpts),n=0;n<i.length;n++){var l=i[n];r.productId==l.productId&&r.productColorId==l.productColorId&&s==JSON.stringify(l.attrOpts)&&(l.productNum=l.productNum+r.productNum,o=!0)}if(!o){i.push(r);for(var n=0;n<i.length;n++)"2"==i[n].prdAttrFlg&&(i.push(i[n]),i.splice(n,1))}}localStorage.productList=JSON.stringify(i);for(var d=0,n=0;n<i.length;n++)d=parseInt(d)+parseInt(i[n].productNum);t("#cart_product_number").html(d),t("#cart_product_number").show(),t("#mb_cart_product_number").html(d),t("#mb_cart_product_number").show(),x(),y()}function h(t){for(var e=0;e<t.length;e++)for(var i=t[e],a=JSON.stringify(i.attrOpts),r=e+1;r<t.length;r++){var o=t[r];a==JSON.stringify(o.attrOpts)&&(i.productNum=i.productNum+o.productNum,t.splice(r,1),r-=1)}return t}function g(e){var i=[];if(1==e){for(var a=t("#qty_input").val()?Number(t("#qty_input").val()):1,o={userId:r.util.getUserId(),productId:dt.productId,productName:dt.productName,productImage:dt.productImage,productColorId:dt.productColorId,productNum:a,attrOpts:[],attrString:""},s=null,n=0;n<lt.color_data[0].dyn_attrs.length;n++){var l={},d=lt.color_data[0].dyn_attrs[n];if(!(t("#"+L(d.attrID)+"_list").find(".selected").length>0)&&"3"!=d.attrID&&"4"!=d.attrID)return void alert(t.i18n.map.NoAttr+" "+d.attr_name);if("3"==d.attrID)l.attrType=d.attrID,l.attrOptId=d.input_cmp.optId,l.custominfo=t("#print_number_input").val(),l.custominfo&&(s=null==s?d.attr_name+": "+l.custominfo:s+","+d.attr_name+": "+l.custominfo),o.attrOpts.push(l);else if("4"==d.attrID)l.attrType=d.attrID,l.attrOptId=d.input_cmp.optId,l.custominfo=t("#print_name_input").val(),l.custominfo&&(s=null==s?d.attr_name+": "+l.custominfo:s+","+d.attr_name+": "+l.custominfo),o.attrOpts.push(l);else{var c=t("#"+L(d.attrID)+"_list").find(".selected").children().eq(0).text(),u=t("#"+L(d.attrID)+"_list").find(".selected").data().data;s=null==s?d.attr_name+": "+c:s+","+d.attr_name+": "+c,l.attrType=d.attrID,l.attrOptId=u,o.attrOpts.push(l)}}o.attrString=s,i.push(JSON.parse(JSON.stringify(o)))}else if(2==e){var o={userId:r.util.getUserId(),productId:dt.productId,productColorId:dt.productColorId,productName:dt.productName,productImage:dt.productImage,productNum:1,attrOpts:[{attrType:"",attrOptId:"",custominfo:""}]};if(pt&&pt.length>0)for(var n=0;n<pt.length;n++)for(var p=pt[n],m=0;m<p.customs.length;m++){for(var l=[{attrType:p.attrType,attrOptId:p.optId}],_=p.customs[m].attrs,g=0;g<_.length;g++){var f=_[g],v=t("#print_input_"+p.optId+"_"+f.attrID+"_"+f.position).val();l.push({attrType:f.attrID,attrOptId:f.input_cmp.optId,custominfo:v})}o.attrOpts=l,i.push(JSON.parse(JSON.stringify(o)))}}return h(i)}function f(){ut&&ut.length>0&&(t("#size_list").html(t("#customSizeItem").tmpl(ut)),t("#size_list select option[value=11]").html(t.i18n.map.MoreNumber),k(!1),t("#size_list select").change(function(){console.log("#size_list select value = "+t(this).val()),"11"==t(this).val()?(t(this).hide(),t(this).parent().find("input").show()):k(!0)}),t("#size_list input").blur(function(){console.log("#size_list input");var e=t(this).val();if(console.log("#size_list input number = "+e),e&&e<=10){var i=t(this).parent().find("select")[0].id;t("#"+i.substring(i.indexOf("_")+1)+" option[value="+e+"]").prop("selected","selected")}else if(e&&e>10){var i=t(this).parent().find("select")[0].id,a="#"+i.substring(i.indexOf("_")+1);t(a).hide(),t(a).parent().find("input").show(),t(a).parent().find("input").val(e)}k(!0)})),c()}function v(){f(),t("#custom_wrap_mask").removeClass("hide"),t("body").css("overflow","hidden")}function b(e){for(var i=[],a=0;a<ut.length;a++){var r=ut[a],o=t("#custom_"+r.optId+"_number_list").val();if(Number(o)>10&&(o=t("#"+r.optId+"_number_input").val()),e||!r.number?r.number=o:Number(r.number)>Number(o)&&(o=r.number),Number(o)<=10?t("#custom_"+r.optId+"_number_list option[value="+o+"]").prop("selected","selected"):(t("#custom_"+r.optId+"_number_list").hide(),t("#custom_"+r.optId+"_number_list").parent().find("input").show(),t("#custom_"+r.optId+"_number_list").parent().find("input").val(o)),r.customs=[],o>0){for(var s=0;s<o;s++){for(var n=0;n<mt.length;n++){mt[n].position=s;var l=t("#print_input_"+r.optId+"_"+mt[n].attrID+"_"+mt[n].position).val();mt[n].custominfo=l}r.customs.push(JSON.parse(JSON.stringify({attrs:mt})))}i.push(r)}}return i}function y(){t("#custom_wrap_mask").addClass("hide"),t("body").css("overflow","auto")}function C(e){t("#productImageList").html(t("#productImageTempl").tmpl(e)),null!=wt?(wt.update(),wt.slideTo(0)):wt=new Swiper("#bigimage_swiper",{slidesPerView:1,initialSlide:0,effect:"flip",grabCursor:!0,nextButton:"#bigimage_swiper .swiper-button-next",prevButton:"#bigimage_swiper .swiper-button-prev",onSlideChangeStart:function(e){t("#productSmallImageList img").removeClass("selected"),t("#productSmallImageList img").eq(e.activeIndex).addClass("selected");var i=t("#productSmallImageList img").eq(e.activeIndex).parent();if(!i.hasClass("swiper-slide-visible"))if(i.index()>It.activeIndex){console.log(It.height),console.log(i.height());var a=Math.floor(It.height/(i.height()+10))-1;It.slideTo(i.index()-a)}else It.slideTo(i.index())}}),t(".thumbnail-wrap .swiper-button-next").on("click",function(t){if(t.preventDefault(),wt.activeIndex==wt.slides.length-1)return void wt.slideTo(0,1e3);wt.slideNext()}),t(".thumbnail-wrap .swiper-button-prev").on("click",function(t){if(t.preventDefault(),0==wt.activeIndex)return void wt.slideTo(wt.slides.length-1,1e3);wt.slidePrev()}),t("#productSmallImageList").html(t("#productSmallImageTempl").tmpl(e)),null!=It?(It.update(),It.slideTo(0)):It=new Swiper("#thumbnail_swiper",{slidesPerView:"auto",direction:"vertical",allowTouchMove:!1,initialSlide:0,onTap:function(){wt.slideTo(It.clickedIndex)}}),t("#product_small_image_0 img").addClass("selected"),t("#imageLoading").addClass("hide"),t("#midimg").load(function(t){console.log("big image loading"),null!==ht&&d(),ct.push(t.currentTarget.currentSrc)}),t("#midimg").error(function(){console.log("big image error"),null!==ht&&d()}),t("#productSmallImageList img").click(function(){t("#productSmallImageList img").removeClass("selected"),t(this).addClass("selected");var e=t(this).parent().data().data;wt.slideTo(e)}),t("#productImageList img").each(function(){ft?t("#productImageList").viewer("update"):ft=t("#productImageList").viewer({url:"data-src",toolbar:{zoomIn:!1,zoomOut:!1,oneToOne:!1,reset:!1,prev:{show:!0,size:"large"},play:!1,next:{show:!0,size:"large"},rotateLeft:!1,rotateRight:!1,flipHorizontal:!1,flipVertical:!1},navbar:!1,movable:!0,title:!1,transition:!1,button:!1})})}function w(e){1==e.length?(dt.productColorId=e[0].color_id,dt.productColor=e[0].color_des,dt.productName=e[0].pcName,dt.productImage=e[0].img_groups[0].big_img,B(e[0].isattention)):(t("#color_data_wrap").removeClass("hide"),t("#color_list").html(t("#colorItem").tmpl(e)),t(t("#color_list li")[nt]).find("span").css("display","block"),t(t("#color_list li")[nt]).find("img").addClass("selected-image-border"),t("#color_desc").html(e[nt].color_des),dt.productColorId=e[nt].color_id,dt.productColor=e[nt].color_des,dt.productName=e[nt].pcName,dt.productImage=e[nt].img_groups[0].big_img,B(e[nt].isattention),t("#color_list li").bind("click",function(){if("none"==t(this).find("span").css("display")){for(var i=lt.color_data[nt],a=[],r=0;r<i.dyn_attrs.length;r++){var o={},s=i.dyn_attrs[r];if(t("#"+L(s.attrID)+"_list").find(".selected").length>0){var n=t("#"+L(s.attrID)+"_list").find(".selected").data().data;o.attrType=s.attrID,o.attrOptId=n,a.push(o)}}t("#color_list li").find("span").css("display","none"),t("#color_list li").find("img").removeClass("selected-image-border"),t(this).find("span").css("display","block"),t(this).find("img").addClass("selected-image-border");var l=t(this).data().data;t("#color_desc").html(e[l].color_des),t("#name").html(e[l].pcName),t("#product_ext_name").html(e[l].pcNameExt),t("#current_price").html(e[l].current_price),e[l].disCount&&"-0"!=e[l].disCount?(t("#price_off").html(Math.abs(Number(e[l].disCount))+"% OFF"),t("#original_price").html(e[l].original_price)):(t("#price_off").hide(),t("#original_price").hide()),dt.productColorId=e[l].color_id,dt.productColor=e[l].color_des,dt.productName=e[l].pcName,dt.productImage=e[l].img_groups[0].small_img,B(e[l].isattention),ht=e[l].videos&&e[l].videos.length>0?e[l].videos[0].path:null,C(e[l].img_groups),a.length>0?I(e[l].dyn_attrs,a):I(e[l].dyn_attrs)}}))}function I(e,i){e&&e.length>0?t("#dyn_attrs_list").removeClass("hide"):t("#dyn_attrs_list").addClass("hide"),_t=!1,mt=[],ut=[],t("#customBtn").addClass("hide"),t("#attr_name_hint").html(t.i18n.map.PrintNameHint),t("#attr_number_hint").html(t.i18n.map.PrintNumberHint);for(var a=r.util.getCurrencySymbol(r.util.getLocalCurrency()),o=0;o<e.length;o++){var s=e[o];if(s.domain_list&&s.domain_list.length>0&&(t("#"+s.attr_name+"_content").html(s.domain_list[0]),s.selectedAttr=s.domain_list[0].optId,s.attr_name_id=L(s.attrID),"2"==s.attrID))for(var n=0;n<s.domain_list.length;n++){var l=s.domain_list[n];l.attrType=s.attrID,ut.push(l)}s.input_cmp&&(mt.push(s),_t=!0,t("#customBtn").removeClass("hide")),"3"==s.attrID&&(t("#print_number_price").html("+"+r.util.formatProductPrice(s.input_cmp.price,a)),t("#detail_print_number_price").html("+"+r.util.formatProductPrice(s.input_cmp.price,a))),"4"==s.attrID&&(t("#print_name_price").html("+"+r.util.formatProductPrice(s.input_cmp.price,a)),t("#detail_print_name_price").html("+"+r.util.formatProductPrice(s.input_cmp.price,a)))}if(t("#dyn_attrs_list").html(t("#dynAttrsItem").tmpl(e)),t("#dyn_attrs_list .attr-item").click(function(){if(t(this).hasClass("selected"))t(this).removeClass("selected"),t(this).parent().siblings().eq(0).find(".attr-value").html("");else{var e=t(this).children().eq(0).text();t(this).parent().siblings().eq(0).find(".attr-value").html(e),t(this).siblings().removeClass("selected"),t(this).addClass("selected")}}),i&&i.length>0)for(var o=0;o<i.length;o++){var l=i[o];t("#dyn_attrs_list #"+l.attrType+"_list li[data-data="+l.attrOptId+"]").addClass("selected")}"0"==sessionStorage.size_guide||""==sessionStorage.size_guide?t("#size_guide").addClass("hide"):(t("#size_guide").html(t.i18n.map.SizeGuide),t("#size_guide").removeClass("hide")),_t?t("#print_number_input")[0]||(t("#custom_wrap").removeClass("hide"),t("#custom_type_list").val(0),t("#custom_attrs_list").hide(),t("#custom_attrs_list").html(t("#customAttrsItem").tmpl(mt))):t("#custom_wrap").addClass("hide"),t("#dyn_attrs_list input").blur(function(){var e=t(this).val();if(e<=10){var i=t(this).parent().find("select")[0].id;t("#custom_"+i+" option[value="+e+"]").prop("selected","selected")}else{var i=t(this).parent().find("select")[0].id,a="#"+i;t(a).hide(),t(a).parent().find("input").show(),t(a).parent().find("input").val(e)}})}function k(e){pt=b(e),t("#custome_attr_list").html(""),t("#custome_attr_list").html(t("#customAttrItem").tmpl(pt))}function S(){r.dao.productDetail({productId:rt,currencyId:r.util.getLocalCurrency(),userId:r.util.getUserId(),ismb:0},function(e){if(e.product_id){e.statistic&&(e.statistic.commented&&e.statistic.commented>0&&(t("#detail_review_number").html(t.i18n.map.CommentNumber.replace("$number",e.statistic.commented)),t("#detail_review_number").removeClass("hide")),e.statistic.saled&&e.statistic.saled>0&&(t("#detail_sold_number").html(t.i18n.map.soldedHint.replace("$number",e.statistic.saled)),t("#detail_sold_number").removeClass("hide")),e.statistic.loved&&e.statistic.loved>0?(t("#detail_fav_number").html("("+e.statistic.loved+")"),t("#detail_fav_number").removeClass("hide")):t("#detail_fav_number").addClass("hide")),lt=e;var i=e;dt.productId=lt.product_id;for(var a=r.util.getCurrencySymbol(r.util.getLocalCurrency()),o=0;o<i.color_data.length;o++){var s=i.color_data[o];s.original_price=r.util.formatProductPrice(s.original_price,a),s.current_price=r.util.formatProductPrice(s.current_price,a),s.img_display=r.util.picUrl+s.img_display,s.color_img=r.util.picUrl+s.color_img,s.width=200,s.height=200;for(var n=0;n<s.img_groups.length;n++){var l=s.img_groups[n];l.small_img=r.util.picUrl+l.small_img,l.big_img=r.util.picUrl+l.big_img}}i.product_des?(t(".description").html(i.product_des),"3"==sessionStorage.pop_menu_style?t(".description").removeClass("hide"):t(".description").parent().parent().removeClass("hide")):(t("#product_image_wrap").css("border-top","none"),t("#product_image_wrap").css("margin-top","0"),t("#product_image_wrap").css("padding-top","0")),document.title=i.product_name;for(var o=0;o<i.color_data.length;o++)if(ot==i.color_data[o].color_id){nt=o;break}if(i.attrFlg&&!0&i.attrFlg?t("#new_label").show():t("#new_label").hide(),ht=i.color_data[nt].videos&&i.color_data[nt].videos.length>0?i.color_data[nt].videos[0].path:null,C(i.color_data[nt].img_groups),t("#name").html(i.color_data[nt].pcName),t("#product_ext_name").html(i.color_data[nt].pcNameExt),t("#current_price").html(i.color_data[nt].current_price),i.flashobj&&1==i.flashobj.status?(t("#flash_sale_icon").removeClass("hide"),t("#flash_sale_wrap").removeClass("hide"),Ct=i.flashobj.gap,X()):(t("#flash_sale_icon").addClass("hide"),t("#flash_sale_wrap").addClass("hide")),i.color_data[nt].disCount&&"-0"!=i.color_data[nt].disCount?(t("#price_off").html(Math.abs(Number(i.color_data[nt].disCount))+"% OFF"),t("#original_price").html(i.color_data[nt].original_price)):(t("#price_off").hide(),t("#original_price").hide()),i.attrFlg&&2==(2&i.attrFlg)?t("#original_price_wrap").addClass("hide"):t("#original_price_wrap").removeClass("hide"),"0"==i.color_data[nt].isFreeShipping)if(i.advtxts&&i.advtxts.length>0){for(var d="",o=0;o<i.advtxts.length;o++)d=d+i.advtxts[o]+"<br>";t("#shipping_info").html(d),t("#shipping_info").parent().parent().show()}else t("#shipping_info").parent().parent().hide();else"1"==i.color_data[nt].isFreeShipping?t("#shipping_info").html(t.i18n.map.FreeshippingHint):t("#shipping_info").parent().parent().hide();if(t("#price_wrap").css("display","block"),ot||(ot=i.color_data[nt].color_id),w(i.color_data),"3"==sessionStorage.pop_menu_style?$():2!=(2&i.attrFlg)&&G(i.product_type),i.subprds&&i.subprds.length>0){t("#zuhe_product_wrap").removeClass("hide"),V(i.subprds),Q(i.subprds);var c=r.util.formatProductPrice(i.color_data[nt].current_price,a),u=r.util.formatProductPrice(i.color_data[nt].subprdtotal,a),p=r.util.formatProductPrice(i.color_data[nt].saveprice,a);t("#subprdCurrentPrice").html(c),t("#subprdtotal").html(u),t("#subprdSaveprice").html(p)}else t("#zuhe_product_wrap").addClass("hide"),I(i.color_data[nt].dyn_attrs);t(".product-info-wrap").removeClass("hide"),t(".product-placeholder-wrap").addClass("hide"),"3"!==sessionStorage.pop_menu_style&&(2==(2&i.attrFlg)?R():(r.util.menu=[],r.util.getClassifyNames(i.product_type,function(){r.util.menu&&r.util.menu.length>0?(P(),R()):t(".breadcrumb").hide()}))),r.util.isMobile()?t("#web_shipping_hit").addClass("hide"):t("#web_shipping_hit").removeClass("hide"),2!=(2&i.attrFlg)&&T(),t("#print_wrap").show(),K(r.util.isMobile()?i.sg_mb:i.sg_pc)}})}function P(){if(r.util.menu&&r.util.menu.length>0){var e=r.util.encodeMenuType(r.util.getUvid()),i=r.util.getAdvSource().u;i||(i=r.util.getQueryString("u"));var a="";a=i?"?u="+i+"&uvid="+e:"?uvid="+e;var o=JSON.parse(JSON.stringify(r.util.menu.reverse()));o.push({menu_name:document.title});for(var s="<li><a id='breadcrumb_home' href='/'>"+t.i18n.map.Home+"</a></li>",n=0;n<o.length;n++)if(n!==o.length-1){var l=r.util.formatProductName(o[n].menu_name)+"-l-"+r.util.encodeMenuType(o[n].menu_type)+".html"+a;"1"==o[n].supportgp&&(l=r.util.formatProductName(o[n].menu_name)+"-g-"+r.util.encodeMenuType(o[n].menu_type)+".html"+a),s=s+"<li><a href='"+l+"'>"+o[n].menu_name+"</a></li>"}t(".breadcrumb").html(s),t(".breadcrumb").removeClass("hide")}}function T(){var t=localStorage.currentBrowseList;t=t?JSON.parse(t):[];for(var e=0;e<t.length;e++){var i=t[e];if(i.productId===rt&&i.productColorId===ot){t.splice(e,1);break}}var a={productId:rt,productColorId:ot};t.push(a),t.length>30&&(t=t.splice(1,t.length-1)),localStorage.setItem("currentBrowseList",JSON.stringify(t))}function N(){t("#waitting_icon").removeClass("hide"),t("#success_icon").addClass("hide"),t("#success_text").addClass("hide"),t("#add_to_cart_success_mask").removeClass("hide"),t("body").css("overflow","hidden")}function x(){t("#waitting_icon").addClass("hide"),t("#success_icon").removeClass("hide"),t("#success_text").removeClass("hide")}function z(){t("#add_to_cart_success_mask").addClass("hide"),t("body").css("overflow","auto")}function L(t){return t}function O(){r.dao.getCommentsByPrd({currentPage:gt.curPage,productId:rt,userId:r.util.getUserId()},function(e){if(!e)return t("#comment_list_wrap").addClass("hide"),void t("#product_star").addClass("hide");if(e.avgEval&&(t("#product_star_input").rating({step:.1,size:"xs",showClear:!1,min:0,max:5,disabled:!0,showCaption:!1}).rating("showStars",e.avgEval),t("#product_star_text").html(e.avgEval),t("#product_star").removeClass("hide")),e.page&&(gt.amount=e.page.amount,gt.pageSize=e.page.pageSize),e&&e.comments.length>0){for(var i=e.comments,a=0;a<i.length;a++){var o=i[a];o.crtime=r.util.formatOrderDateTime(o.crtime),o.usrico&&(o.usrImage=r.util.userIconUrl+o.usrico,o.usrErrorImage='javascript:this.src="resources/img/user/'+o.usrico+'";');for(var s=0;s<o.zps.length;s++){var n=o.zps[s];n.crtime=r.util.formatOrderDateTime(n.crtime);for(var l=0;l<n.shareimgs.length;l++)n.shareimgs[l]=r.util.commentPicUrl+n.shareimgs[l]}for(var s=0;s<o.shareimgs.length;s++)o.shareimgs[s]=r.util.commentPicUrl+o.shareimgs[s]}t("#comment_list").html(t("#commentItemTempl").tmpl(i)),t("#comment_list #color_title").html(t.i18n.map.ColorTitle),t("#comment_list .reply-text").html(t.i18n.map.DetailCommentReply),t("#comment_list img.lazy").lazyload({effect:"fadeIn"}),t(".empty-data").addClass("hide"),t("#comment_list .comment-item-wrap input").each(function(){t(this).rating({step:1,size:"xs",showClear:!1,min:0,max:5,disabled:!0,showCaption:!1}).rating("showStars",t(this).data().data)}),t("#comment_list .image-wrap img").each(function(){t(this).click(function(){t(this).parent().find("img").removeClass("selected"),t(this).addClass("selected"),M(t(this).parent())})}),t("#comment_list .top-wrap").each(function(){t(this).click(function(){var e=t(this).data().data;if(e){t("#iframe_loading").removeClass("hide"),t("#video").addClass("hide"),t("#video").attr("src",e);document.getElementById("video").onload=function(){t("#iframe_loading").addClass("hide"),t("#video").removeClass("hide")}}t("#video_mask").removeClass("hide"),t("#video_mask #close_video_btn").click(function(){t("#video").attr("src",""),t("#video_mask").addClass("hide")})})}),t("#comment_list .comment-item-wrap .msg-item").each(function(){t(this).click(function(){if(r.util.checkIsLogin())window.location.href="../../../comment_detail.html?cmId="+t(this).data().data;else{var e=r.util.encodeMenuType(r.util.getUvid());window.location.href="../../../login.html?uvid="+e}})}),t("#comment_list .comment-item-wrap .prise-item").each(function(){t(this).click(function(){if(r.util.checkIsLogin()){var e=0;t(this).find("i").hasClass("icon-dianzan")&&(e=1),r.dao.userPrise({cmId:t(this).data().data,userId:r.util.getUserId(),type:e},function(){gt.curPage=1,O()})}else{var i=r.util.encodeMenuType(r.util.getUvid());window.location.href="../../../login.html?uvid="+i}})})}else t(".empty-data").removeClass("hide")})}function M(t){yt=t.viewer({url:"data-original",toolbar:{zoomIn:!1,zoomOut:!1,oneToOne:!1,reset:!1,prev:{show:!0,size:"large"},play:!1,next:{show:!0,size:"large"},rotateLeft:!1,rotateRight:!1,flipHorizontal:!1,flipVertical:!1},navbar:!1,movable:!0,title:!1,transition:!1,button:!0,hide:function(){t.find("img").removeClass("selected")}})}function B(e){r.util.checkIsLogin()&&("1"==e?(t("#add_fav").addClass("selected"),t("#add_fav").removeClass("icon-heart "),t("#add_fav").addClass("icon-aixin")):t("#add_fav").removeClass("selected")),t("#add_fav").removeClass("hide"),t("#btn_wrap").removeClass("hide"),t("#addFavBtn").unbind("click").click(function(){if(r.util.checkIsLogin())r.dao.attentionProduct({userId:r.util.getUserId(),productId:dt.productId,colorId:dt.productColorId,type:t("#add_fav").hasClass("selected")?"2":"1"},function(e){t("#add_fav").hasClass("selected")?(t("#add_fav").removeClass("selected"),t("#add_fav").removeClass("icon-aixin"),t("#add_fav").addClass("icon-heart ")):(t("#add_fav").removeClass("icon-heart"),t("#add_fav").addClass("selected"),t("#add_fav").addClass("icon-aixin")),e.loved&&e.loved>0?(t("#detail_fav_number").html("("+e.loved+")"),t("#detail_fav_number").removeClass("hide")):t("#detail_fav_number").addClass("hide")});else{var e=r.util.encodeMenuType(r.util.getUvid());window.location.href="../../../login.html?uvid="+e}})}function U(){r.dao.listImgWall({currentPage:vt.curPage,terminal:r.util.isMobile()?"2":"1",currencyId:r.util.getLocalCurrency(),prdId:rt},function(e){if(e.page){if(1==vt.curPage){vt.amount=e.page.amount,vt.pageSize=e.page.pageSize;var i=0;i=vt.amount%vt.pageSize==0?parseInt(vt.amount/vt.pageSize):parseInt(vt.amount/vt.pageSize)+1,vt.totalPage=i}}else vt.totalPage=0,vt.amount=0;0==vt.amount?t("#pic_wall_list_wrap").addClass("hide"):(t("#pic_wall_list_wrap").removeClass("hide"),1==vt.curPage&&(s.init(document.getElementById("cells"),document.getElementById("picWallTempl").innerHTML),s.setCompleteCallback(function(){t("#cell_loading").addClass("hide"),E(),vt.curPage==vt.totalPage&&t("#more_btn").addClass("hide")})),s.loadingData=!0,s.concatData(D(e.imgs)))})}function D(t){for(var e=0;e<t.length;e++){var i=t[e];i.aiName=r.util.imgWallUrl+i.aiName,i&&i.aiHref?i.aiHref=i.aiHref:i.aiHref="javascript:void(0)";var a=r.util.getCurrencySymbol(r.util.getLocalCurrency());i.curPrice=r.util.formatProductPrice(i.curPrice,a),i.orgPrice=r.util.formatProductPrice(i.orgPrice,a)}return t}function E(){t("#cells img").each(function(){t(this).click(function(){bt?t("#cells").viewer("update"):bt=t("#cells").viewer({url:"data-original",toolbar:{zoomIn:!1,zoomOut:!1,oneToOne:!1,reset:!1,prev:{show:!0,size:"large"},play:!1,next:{show:!0,size:"large"},rotateLeft:!1,rotateRight:!1,flipHorizontal:!1,flipVertical:!1},navbar:!1,movable:!0,title:!1,transition:!1,button:!1,hide:function(){t("#wall_buy_wrap").addClass("hide")},show:function(){t("#wall_buy_wrap").removeClass("hide"),q(s.picData[bt[0].viewer.index].cp)},view:function(e){var i=s.picData[e.detail.index];t("#wall_buy_btn").attr("href",i.aiHref),i.productName?(t("#wall_product_name").html(i.productName),t("#wall_product_price").html(i.curPrice),t("#wall_product_del_price").html(i.orgPrice)):(t("#wall_product_name").html(""),t("#wall_product_price").html(""),t("#wall_product_del_price").html(""))}})})})}function R(){var e=JSON.parse(sessionStorage.menus);if(e=r.util.handleMenu(e)){if(t("#menu_list_wrap").html(t("#menuListTempl").tmpl(e)),t("#menu_list_wrap a").each(function(){t(this).click(function(){event.stopPropagation();var e=r.util.getAdvSource().u;e||(e=r.util.getQueryString("u"));var i="";e&&(i="?u="+e);var a=r.util.encodeMenuType(r.util.getUvid()),o=t(this).attr("href");if(o&&o.indexOf("-l-")>-1){var s=r.util.getListParams(o),n=s[s.length-2];n=r.util.encodeMenuType(n);var l=o.substring(0,o.indexOf("-l-")),d=r.util.formatProductName(l)+"-l-"+n+"-"+a+".html"+i;t(this).attr("href",d)}else if(o&&o.indexOf("-g-")>-1){var s=r.util.getListParams(o),n=s[s.length-2];n=r.util.encodeMenuType(n);var l=o.substring(0,o.indexOf("-g-")),d=r.util.formatProductName(l)+"-g-"+n+"-"+a+".html"+i;t(this).attr("href",d)}})}),sessionStorage.selected_category_id)for(var i=t("#menu_list_wrap span"),a=0;a<i.length;a++)i[a].id==sessionStorage.selected_category_id?(t(i[a]).addClass("sale-selected"),t(i[a]).parent().parent().parent().find("li .classify-title").addClass("red")):t(i[a]).removeClass("sale-selected"),0==r.util.menu.length&&i[a].id==sessionStorage.selected_category_id&&"menu_list_wrap"!==t(i[a]).parent().parent().parent()[0].id&&"div"!==t(i[a]).parent().parent().parent()[0].tagName.toLowerCase()&&(t(i[a]).parent().parent().parent().find("ul:first").css("display","block"),t(i[a]).parent().parent().parent().find(".icon-21:first").addClass("icon-jianhao"),t(i[a]).parent().parent().parent().find(".icon-21:first").removeClass("icon-21"));if(r.util.menu&&r.util.menu.length>0)for(var o=r.util.menu[r.util.menu.length-1].menu_type,i=t("#menu_list_wrap span"),a=0;a<i.length;a++){i[a].id==o?t(i[a]).addClass("selected"):t(i[a]).removeClass("selected");for(var s=0;s<r.util.menu.length;s++)if(i[a].id==r.util.menu[s].menu_type){"menu_list_wrap"!==t(i[a]).parent().parent().parent()[0].id&&"div"!==t(i[a]).parent().parent().parent()[0].tagName.toLowerCase()&&(t(i[a]).parent().parent().parent().find("ul:first").css("display","block"),t(i[a]).parent().parent().parent().find(".icon-21:first").addClass("icon-jianhao"),t(i[a]).parent().parent().parent().find(".icon-21:first").removeClass("icon-21"),t(i[a]).parent().parent().parent().css("background","#F5F5F5"));break}}t("#menu_list_wrap #arrow_icon").bind("click",function(){event.stopPropagation(),t(this).find("i").hasClass("icon-21")?(t(this).parent().parent().css("background","#F5F5F5"),t(this).parent().find(".left-title-wrap .classify-title").addClass("open"),t(this).parent().parent().find("ul:first").slideDown(500),t(this).find("i").removeClass("icon-21"),t(this).find("i").addClass("icon-jianhao")):(t(this).parent().hasClass("second-menu-item")||t(this).parent().parent().css("background","#fff"),t(this).parent().find(".left-title-wrap .classify-title").removeClass("open"),t(this).parent().parent().find("ul:first").slideUp(500),t(this).find("i").addClass("icon-21"),t(this).find("i").removeClass("icon-jianhao"))})}}function q(t){var e,i=r.statistic.getPerformanceTiming();e=i?{page:"/imgwall?cp="+t,t_leaving:i.startTime,t_ldpage:i.loadPage,t_enter:i.startTime,uvid:r.util.getUvid(),ctryCode:r.util.getCookie("current_country"),referer:document.referrer}:{page:"/imgwall?cp="+t,t_leaving:(new Date).getTime(),t_ldpage:(new Date).getTime(),t_enter:(new Date).getTime(),uvid:r.util.getUvid(),ctryCode:r.util.getCookie("current_country"),referer:document.referrer},r.dao.statistic(e,function(){})}function H(){t("#custom_function_wrap").html(""),r.dao.getallviewofprd({currencyId:r.util.getLocalCurrency(),prdId:rt,userId:r.util.getUserId(),terminal:r.util.isMobile()?"2":"1"},function(e){for(var i=0;i<e.length;i++){var a=e[i];"pvr-pl"==a.key?F(a):"pvr-iw"==a.key?J(a):"pvr-xh"==a.key?A(a):"pvr-tl"==a.key||"pvr-dp"==a.key&&j(a)}t("#custom_function_wrap [data-i18n-text]").each(function(){var e=t(this).html(),i=/<(.*)>/;if(i.test(e)){var a=i.exec(e)[0];t(this).html(a+t.i18n.prop(t(this).data("i18n-text")))}else t(this).text(t.i18n.prop(t(this).data("i18n-text")))})})}function F(e){var i=document.createElement("div");if(n.front(document.getElementById("commentTempl").innerHTML,{},i),document.getElementById("custom_function_wrap").appendChild(i),e.avgEval?(t("#product_star_input").rating({step:.1,size:"xs",showClear:!1,min:0,max:5,disabled:!0,showCaption:!1}).rating("showStars",e.avgEval),t("#product_star_text").html(e.avgEval),t("#product_star").removeClass("hide"),
t("#comment_tab").removeClass("hide")):t("#comment_tab").addClass("hide"),e.page&&(gt.amount=e.page.amount,gt.pageSize=e.page.pageSize),e&&e.comments.length>0){for(var a=e.comments,o=0;o<a.length;o++){var s=a[o];s.crtime=r.util.formatOrderDateTime(s.crtime),s.usrico&&(s.usrImage=r.util.userIconUrl+s.usrico,s.usrErrorImage='javascript:this.src="resources/img/user/'+s.usrico+'";');for(var l=0;l<s.zps.length;l++){var d=s.zps[l];d.crtime=r.util.formatOrderDateTime(d.crtime);for(var c=0;c<d.shareimgs.length;c++)d.shareimgs[c]=r.util.commentPicUrl+d.shareimgs[c]}for(var l=0;l<s.shareimgs.length;l++)s.shareimgs[l]=r.util.commentPicUrl+s.shareimgs[l]}t("#comment_list").html(t("#commentItemTempl").tmpl(a)),t("#comment_list #color_title").html(t.i18n.map.ColorTitle),t("#comment_list .reply-text").html(t.i18n.map.DetailCommentReply),t("#comment_list img.lazy").lazyload({effect:"fadeIn"}),t(".empty-data").addClass("hide"),t("#comment_list .comment-item-wrap input").each(function(){t(this).rating({step:1,size:"xs",showClear:!1,min:0,max:5,disabled:!0,showCaption:!1}).rating("showStars",t(this).data().data)}),t("#comment_list .image-wrap img").each(function(){t(this).click(function(){t(this).parent().find("img").removeClass("selected"),t(this).addClass("selected"),M(t(this).parent())})}),t("#comment_list .top-wrap").each(function(){t(this).click(function(){var e=t(this).data().data;if(e){t("#iframe_loading").removeClass("hide"),t("#video").addClass("hide"),t("#video").attr("src",e);document.getElementById("video").onload=function(){t("#iframe_loading").addClass("hide"),t("#video").removeClass("hide")}}t("#video_mask").removeClass("hide"),t("#video_mask #close_video_btn").click(function(){t("#video").attr("src",""),t("#video_mask").addClass("hide")})})}),t("#comment_list .comment-item-wrap .msg-item").each(function(){t(this).click(function(){if(r.util.checkIsLogin())window.location.href="../../../comment_detail.html?cmId="+t(this).data().data;else{var e=r.util.encodeMenuType(r.util.getUvid());window.location.href="../../../login.html?uvid="+e}})}),t("#comment_list .comment-item-wrap .prise-item").each(function(){t(this).click(function(){if(r.util.checkIsLogin()){var e=0;t(this).find("i").hasClass("icon-dianzan")&&(e=1),r.dao.userPrise({cmId:Number(t(this).data().data),userId:r.util.getUserId(),type:e},function(){gt.curPage=1,O()})}else{var i=r.util.encodeMenuType(r.util.getUvid());window.location.href="../../../login.html?uvid="+i}})})}else t(".empty-data").removeClass("hide")}function J(e){var i=document.createElement("div");if(n.front(document.getElementById("picWallWrapTempl").innerHTML,{},i),document.getElementById("custom_function_wrap").appendChild(i),e.page){if(1==vt.curPage){vt.amount=e.page.amount,vt.pageSize=e.page.pageSize;var a=0;a=vt.amount%vt.pageSize==0?parseInt(vt.amount/vt.pageSize):parseInt(vt.amount/vt.pageSize)+1,vt.totalPage=a}}else vt.totalPage=0,vt.amount=0;0==vt.amount?(t("#pic_wall_list_wrap").addClass("hide"),t("#fashion_show_tab").addClass("hide")):(t("#pic_wall_list_wrap").removeClass("hide"),t("#fashion_show_tab").removeClass("hide"),1==vt.curPage&&(s.init(document.getElementById("cells"),document.getElementById("picWallTempl").innerHTML),s.setCompleteCallback(function(){t("#cell_loading").addClass("hide"),E(),vt.curPage==vt.totalPage&&t("#more_btn").addClass("hide")})),s.loadingData=!0,s.concatData(D(e.imgs)))}function A(e){var i=document.createElement("div");n.front(document.getElementById("likeRelatedTempl").innerHTML,{},i),document.getElementById("custom_function_wrap").appendChild(i),1==e.style&&(t("#likeRelatedList").addClass("mhn-slide"),t("#likeRelatedList").addClass("owl-carousel"),t("#likeRelatedList").addClass("owl-theme")),t("#like_related_title").html(e.title);var a=e.data;if(a){var o=r.util.getCurrencySymbol(r.util.getLocalCurrency()),s=r.util.getAdvSource().u,l=r.util.encodeMenuType(r.util.getUvid());s||(s=r.util.getQueryString("u"));var d="";d=s?"?u="+s+"&uvid="+l:"?uvid="+l;for(var c=0;c<a.length;c++)for(var u=a[c],p=0;p<u.display_data.length;p++){var m=u.display_data[p];m.original_price=r.util.formatProductPrice(m.original_price,o),m.current_price=r.util.formatProductPrice(m.current_price,o),m.img_display=r.util.picUrl+m.img_display,m.color_img=r.util.picUrl+m.color_img,m.top=Number(r.util.getHomeImageHeight())-70,m.href=r.util.formatProductName(u.product_name)+"-d-"+r.util.encodeMenuType(u.product_id)+"-"+r.util.encodeMenuType(m.color_id)+".html"+d}1==e.style?(t("#likeRelatedList").html(t("#productItemTempl1").tmpl(a)),new Swiper("#likeRelatedList_swiper",{slidesPerView:4,pagination:"#likeRelatedList_swiper .swiper-pagination",paginationClickable:"#likeRelatedList_swiper .swiper-pagination",nextButton:"#likeRelatedList_swiper .swiper-button-next",prevButton:"#likeRelatedList_swiper .swiper-button-prev",spaceBetween:10})):2==e.style&&(t("#likeRelatedList").html(t("#productItemTempl2").tmpl(a)),t("#likeRelatedList img.lazy").lazyload({effect:"fadeIn"}))}}function j(e){var i=document.createElement("div");n.front(document.getElementById("daPeiTempl").innerHTML,{},i),document.getElementById("custom_function_wrap").appendChild(i),1==e.style&&(t("#dapeiList").addClass("mhn-slide"),t("#dapeiList").addClass("owl-carousel"),t("#dapeiList").addClass("owl-theme")),t("#dapei_title").html(e.title);var a=e.data;if(a){var o=r.util.getCurrencySymbol(r.util.getLocalCurrency()),s=r.util.getAdvSource().u,l=r.util.encodeMenuType(r.util.getUvid());s||(s=r.util.getQueryString("u"));var d="";d=s?"?u="+s+"&uvid="+l:"?uvid="+l;for(var c=0;c<a.length;c++)for(var u=a[c],p=0;p<u.display_data.length;p++){var m=u.display_data[p];m.original_price=r.util.formatProductPrice(m.original_price,o),m.current_price=r.util.formatProductPrice(m.current_price,o),m.img_display=r.util.picUrl+m.img_display,m.color_img=r.util.picUrl+m.color_img,m.top=Number(r.util.getHomeImageHeight())-70,m.href=r.util.formatProductName(u.product_name)+"-d-"+r.util.encodeMenuType(u.product_id)+"-"+r.util.encodeMenuType(m.color_id)+".html"+d}t("#dapeiList").html(t("#productItemTempl1").tmpl(a)),1==e.style?new Swiper("#likeRelatedList_swiper",{slidesPerView:4,pagination:"#dapeiList_swiper .swiper-pagination",paginationClickable:"#dapeiList_swiper .swiper-pagination",nextButton:"#dapeiList_swiper .swiper-button-next",prevButton:"#dapeiList_swiper .swiper-button-prev",spaceBetween:10}):2==e.style&&(t("#dapeiList").html(t("#productItemTempl2").tmpl(a)),t("#dapeiList img.lazy").lazyload({effect:"fadeIn"}))}}function V(e){var i=r.util.getCurrencySymbol(r.util.getLocalCurrency()),a=r.util.getAdvSource().u,o=r.util.encodeMenuType(r.util.getUvid());a||(a=r.util.getQueryString("u"));var s="";s=a?"?u="+a+"&uvid="+o:"?uvid="+o;for(var n=0;n<e.length;n++){var l=e[n];l.img_display=r.util.picUrl+l.img_display,l.current_price=r.util.formatProductPrice(l.current_price,i);var d=r.util.formatProductName(l.product_name)+"-d-"+r.util.encodeMenuType(l.product_id)+"-"+r.util.encodeMenuType(l.color_id)+".html"+s;l.href=d}t("#zhuhe_product_list").html(t("#subPrdItem").tmpl(e)),t("#zhuhe_product_list .sub-prd-item:last-child .add-image").addClass("hide"),t("#zhuheTitle").html(t.i18n.map.zhuheTitle+" "+e.length),new Swiper("#zhuhe_product_list_swiper",{slidesPerView:4,pagination:"#zhuhe_product_list_swiper .swiper-pagination",paginationClickable:"#zhuhe_product_list_swiper .swiper-pagination",nextButton:"#zhuhe_product_list_swiper .swiper-button-next",prevButton:"#zhuhe_product_list_swiper .swiper-button-prev",spaceBetween:10})}function Q(e){for(var i=[],a=0;a<e.length;a++){var r=e[a];r.dyn_attrs&&r.dyn_attrs.length>0&&i.push(r)}i.length>0&&(i[0].dyn_attrs&&i[0].dyn_attrs.length>0&&(i[0].showSizeGuide=!0),t("#sub_prds_dyn_attr_list").html(t("#subPrdDynAttrItem").tmpl(i)),i[0].showSizeGuide&&t("#sub_prds_dyn_attr_list #size_guide").html(t.i18n.map.SizeGuide))}function W(){for(var e=t("#qty_input").val()?Number(t("#qty_input").val()):1,i={userId:r.util.getUserId(),productId:lt.product_id,productColorId:lt.color_data[0].color_id,productNum:e,attrOpts:[],subCarts:[],productImage:lt.color_data[0].img_display,productName:lt.product_name,attrString:"",productAttr:[]},a=[],o=0;o<lt.subprds.length;o++){var s={productId:lt.subprds[o].product_id,productColorId:lt.subprds[o].color_id,productNum:e,productImage:lt.subprds[o].img_display,attrOpts:[]};if(lt.subprds[o].dyn_attrs&&lt.subprds[o].dyn_attrs.length>0){for(var n=0;n<lt.subprds[o].dyn_attrs.length;n++){var l={attrType:lt.subprds[o].dyn_attrs[n].attrID,attrOptId:t("#"+lt.subprds[o].product_id+"_"+lt.subprds[o].dyn_attrs[n].attr_name+"_list").val(),attrString:lt.subprds[o].dyn_attrs[n].attr_name+":"+t("#"+lt.subprds[o].product_id+"_"+lt.subprds[o].dyn_attrs[n].attr_name+"_list option:selected").text().trim()};s.attrOpts.push(l)}a.push({productColorId:lt.subprds[o].color_id,attrString:s.attrOpts})}i.subCarts.push(s)}return i.productAttr=a,[i]}function G(e){r.dao.productsRel({menuType:e,currencyId:r.util.getLocalCurrency(),productId:rt,productColorId:dt.productColorId},function(e){var i=r.util.getAdvSource().u,a=r.util.encodeMenuType(r.util.getUvid());i||(i=r.util.getQueryString("u"));var o="";o=i?"?u="+i+"&uvid="+a:"?uvid="+a;for(var s=r.util.getCurrencySymbol(r.util.getLocalCurrency()),n=0;n<e.length;n++){var l=e[n];l.imgDisplay=r.util.picUrl+l.imgDisplay,l.dispcurPrice=r.util.formatProductPrice(l.dispcurPrice,s),l.dispOrgPrice=r.util.formatProductPrice(l.dispOrgPrice,s);var d=r.util.formatProductName(l.prdName)+"-d-"+r.util.encodeMenuType(l.productId)+"-"+r.util.encodeMenuType(l.productColorId)+".html"+o;l.href=d}var c=e;t("#peripheral_products_list").html(t("#recommendProductItemTempl1").tmpl(c)),t("#peripheral_products_list").parent().parent().removeClass("hide")})}function $(){r.dao.hotProducts({currencyId:r.util.getLocalCurrency(),productId:rt,productColorId:dt.productColorId},function(e){var i=r.util.getAdvSource().u,a=r.util.encodeMenuType(r.util.getUvid());i||(i=r.util.getQueryString("u"));var o="";o=i?"?u="+i+"&uvid="+a:"?uvid="+a;for(var s=r.util.getCurrencySymbol(r.util.getLocalCurrency()),n=0;n<e.length;n++){var l=e[n];l.imgDisplay=r.util.picUrl+l.imgDisplay,l.curPrice=r.util.formatProductPrice(l.curPrice,s),l.orgPrice=r.util.formatProductPrice(l.orgPrice,s);var d=r.util.formatProductName(l.prdName)+"-d-"+r.util.encodeMenuType(l.productId)+"-"+r.util.encodeMenuType(l.productColorId)+".html"+o;l.href=d}var c=e;3==sessionStorage.pop_menu_style?(t("#earRecommendList").html(t("#recommendProductItemTempl1").tmpl(c)),new Swiper("#earRecommendList_swiper",{slidesPerView:4,pagination:"#earRecommendList_swiper .swiper-pagination",paginationClickable:"#earRecommendList_swiper .swiper-pagination",nextButton:"#earRecommendList_swiper .swiper-button-next",prevButton:"#earRecommendList_swiper .swiper-button-prev",spaceBetween:10}),t("#earRecommendList").parent().parent().removeClass("hide")):(t("#recommendList").html(t("#recommendProductItemTempl1").tmpl(c)),new Swiper("#recommendList_swiper",{slidesPerView:4,pagination:"#recommendList_swiper .swiper-pagination",paginationClickable:"#recommendList_swiper .swiper-pagination",nextButton:"#recommendList_swiper .swiper-button-next",prevButton:"#recommendList_swiper .swiper-button-prev",spaceBetween:10}),t("#recommendList").parent().parent().removeClass("hide"))})}function K(e){if(e&&e.length>0){for(var i=0;i<e.length;i++)e[i]=r.util.picUrl+e[i];t("#size_guide_image_list").html(t("#sizeGuideImageTempl").tmpl(e))}var a=document.body.clientHeight;t("#size_guide_mask #image_wrap").css("max-height",a-200+"px"),t("#size_guide").unbind("click").click(function(e){t("#size_guide_mask").removeClass("hide"),t("body").css("overflow","hidden")}),t("#size_guide_mask #close_size_guide_btn").unbind("click").click(function(e){t("#size_guide_mask").addClass("hide"),t("body").css("overflow","auto")})}function X(){var e,i,a,r,o;Ct>=0&&(e=Math.floor(Ct/864e5),i=Math.floor(Ct/1e3/60/60%24),a=Math.floor(Ct/1e3/60%60),r=Math.floor(Ct/1e3%60),o=Math.floor(Number(String(Ct).substring(String(Ct).length-3))/100),i+=24*e,i<10?i="0"+i+"h:":i+="h:",a<10?a="0"+a+"m:":a+="m:",r<10?r="0"+r+"s":r+="s",t("#time").text(i+a+r),t("#mill").text(o),Ct-=100,setTimeout(X,100))}function Y(){var t=et("/dfb/");window.open("http://www.facebook.com/sharer.php?u="+encodeURIComponent(t),"_blank","toolbar=yes, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=yes, copyhistory=yes, width=900px, height=600px,top=100,left=350")}function Z(){var t=et("/dtw/"),e=lt.share.title;window.open("https://twitter.com/intent/tweet?url="+encodeURIComponent(t)+"&text="+encodeURIComponent(e),"_blank","toolbar=yes, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=yes, copyhistory=yes, width=900, height=600,top=100,left=350")}function tt(){var t=et("/dp/"),e=lt.share.des,i=lt.share.org;window.open("https://www.pinterest.com/pin/create/button/?url="+encodeURIComponent(t)+"&description="+encodeURIComponent(e)+"&media="+encodeURIComponent(i),"_blank","toolbar=yes, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=yes, copyhistory=yes, width=900, height=600,top=100,left=350")}function et(t){var e=r.util.encodeMenuType(r.util.getLocalCurrency()),i=r.util.encodeMenuType(rt),a=r.util.encodeMenuType(ot),o=r.util.encodeMenuType("0");return r.util.checkIsLogin()&&(o=r.util.encodeMenuType(r.util.getUserId())),"https://"+window.location.host+t+e+"/"+i+"/"+a+"/"+o}var it=window.location.href;if(r.util.isBackstageData())var at=it.split("/"),rt=r.util.Base64.decode(at[5]),ot=r.util.Base64.decode(at[6]);else var st=r.util.getDetailParams(it),rt=r.util.decodeMenuType(st[0]),ot=r.util.decodeMenuType(st[1]);var nt=0,lt={},dt={productId:"",productColorId:""},ct=[],ut=[],pt=[],mt=[],_t=!1,ht=null,gt={amount:0,curPage:1,pageSize:0},ft=null,vt={amount:0,curPage:1,pageSize:0,totalPage:0},bt=null,yt=null,Ct=0,wt=null,It=null;r.setCurrencyCodeCallback(function(){S(),sessionStorage.detailShippingTime&&"undefined"!=sessionStorage.detailShippingTime&&t("#shpping_time").html(sessionStorage.detailShippingTime),console.log(sessionStorage.detailShowMM),sessionStorage.detailShowMM&&"1"==sessionStorage.detailShowMM?t("#detail_M_M").removeClass("hide"):t("#detail_M_M").addClass("hide"),sessionStorage.btn_bg&&(t(".custom-btn").css("background",sessionStorage.btn_bg),t(".add-to-cart-success-mask .add-to-cart-success-wrap #close_add_to_cart_success_btn").css("background",sessionStorage.btn_bg)),sessionStorage.btn_fc&&(t(".custom-btn").css("color",sessionStorage.btn_fc),t(".add-to-carte-success-mask .add-to-cart-success-wrap #close_add_to_cart_success_btn").css("color",sessionStorage.btn_fc)),H()}),r.setLanguageCallback(function(){t("#breadcrumb_home").text(t.i18n.map.Home),t("footer").removeClass("invisibility")}),r.initLoginStatus(),function(){l(),t("#addCartBtn").unbind("click").click(function(){console.log("addCartBtn"),p(1)}),t("#customBtn").click(function(){v()}),t("#coupon_btn").click(function(){var t=r.util.encodeMenuType(r.util.getUvid());r.util.checkIsLogin()?window.location.href="../../../my_account.html?id=4&uvid="+t:window.location.href="../../../login.html?uvid="+t}),t("#reduce_btn").click(function(){var t=document.getElementById("qty_input").value?Number(document.getElementById("qty_input").value):1;t>1&&(t-=1),document.getElementById("qty_input").value=t}),t("#add_btn").click(function(){var t=document.getElementById("qty_input").value?Number(document.getElementById("qty_input").value):1;t<99&&(t+=1),document.getElementById("qty_input").value=t}),document.getElementById("qty_input").value=1,t("#qty_input").on("input",function(){(t(this).val()?Number(t(this).val()):1)>99&&t(this).val(99)}),t("#qty_input").blur(function(){t(this).val()||t(this).val(1)}),t("#custom_type_list").change(function(){"0"==t(this).val()?(t("#custom_attrs_list").css("display","none"),t("#detail_custom_hint").css("display","none"),t("#print_number_input").val(""),t("#print_name_input").val("")):"1"==t(this).val()?(t("#custom_attrs_list").css("display","block"),t("#detail_custom_hint").css("display","block"),t("#custom_item_3").css("display","none"),t("#print_number_input").val(""),t("#custom_item_4").css("display","block")):"2"==t(this).val()?(t("#custom_attrs_list").css("display","block"),t("#detail_custom_hint").css("display","block"),t("#custom_item_3").css("display","block"),t("#custom_item_4").css("display","none"),t("#print_name_input").val("")):"3"==t(this).val()&&(t("#custom_attrs_list").css("display","block"),t("#detail_custom_hint").css("display","block"),t("#custom_item_3").css("display","block"),t("#custom_item_4").css("display","block"))}),t("#add_to_cart_success_mask #close_add_to_cart_success_btn, #add_to_cart_success_mask #continue_shopping_btn").click(function(){z()}),t("#add_to_cart_success_mask #go_to_cart_btn").click(function(){window.location.href="../../../shopping_cart.html",z()}),c(),t(document).on("click",".detail-bottom-content .panel-heading",function(){var e=t(this).parent().find(".panel-body");e.hasClass("hide")?(e.removeClass("hide"),t(this).find(".panel-heading-arrow").removeClass("icon-jiantou-xia-cuxiantiao"),t(this).find(".panel-heading-arrow").addClass("icon-jiantou-shang-cuxiantiao")):(e.addClass("hide"),t(this).find(".panel-heading-arrow").addClass("icon-jiantou-xia-cuxiantiao"),t(this).find(".panel-heading-arrow").removeClass("icon-jiantou-shang-cuxiantiao"))}),t("#prev_btn").unbind("click").click(function(){gt.curPage>1&&(gt.curPage=gt.curPage-1,O()),t("#page").bootstrapPaginator("showPrevious")}),t("#next_btn").unbind("click").click(function(){var e=0;e=gt.amount%gt.pageSize==0?parseInt(gt.amount/gt.pageSize):parseInt(gt.amount/gt.pageSize)+1,gt.curPage<e&&(gt.curPage=gt.curPage+1,O()),t("#page").bootstrapPaginator("showNext")}),t("#contactUsBtn").unbind("click").click(function(){r.util.getUserId()?window.location.href="../../../my_message.html?index=2&productId="+dt.productId+"&productColorId="+dt.productColorId:window.location.href="../../../login.html"}),t("#midimg").unbind("click").click(function(e){ft&&t("#product_image_wrap").viewer("view")}),t("#detail_review_number").unbind("click").click(function(e){t("#detail_tab .tab-item").removeClass("selected"),t("#detail_tab .tab-item").eq(1).addClass("selected"),t("#detail_tab").addClass("fixed"),t("#description").addClass("hide"),t("#custom_function_wrap").removeClass("hide"),t("#shipping_return_desc").addClass("hide"),document.documentElement.scrollTop=document.body.scrollTop=document.getElementById("custom_function_wrap").offsetTop-120}),t(document).on("click","#more_btn",function(){s.loadingData||(vt.curPage=vt.curPage+1,t("#cell_loading").removeClass("hide"),s.loadData(U))}),t(document).on("click","#price_guarantee",function(){document.getElementById("price_guarantee_detail_title").scrollIntoViewIfNeeded()}),t(document).on("click","#mobile_buy_now_btn",function(){3==sessionStorage.pop_menu_style?(N(),p(1)):document.getElementById("addCartBtn").scrollIntoViewIfNeeded()}),t(".share-icon-wrap").hover(function(){t("#share_pop").slideDown()},function(){t("#share_pop").slideUp()}),t("#facebook_href").click(function(){Y()}),t("#twitter_href").click(function(){Z()}),t("#pinterest_href").click(function(){tt()}),t(window).scroll(function(){var e=t(".recommend-list-wrap")[0].offsetTop-120;t(document).scrollTop()>e?(t("#detail_tab").addClass("fixed"),t("#detail_tab").css("left",t(".desc-comment-faq")[0].offsetLeft+20)):t("#detail_tab").removeClass("fixed")})}()});