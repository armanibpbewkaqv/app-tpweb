"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","bootstrapPaginator"],function(t,i,e,a,s,r){function n(){if(t(".pop-content").is(":visible")){t(".pop-content").css("display","none");for(var i=t(".filter-item"),e=0;e<i.length;e++){const a=i[e];t(a).children().eq(1).addClass("icon-hao"),t(a).children().eq(1).removeClass("icon--hao")}}}function o(){t("body").click(function(){n()}),sessionStorage.list_lable_bg&&t(".product-label-item").css("background",sessionStorage.list_lable_bg),sessionStorage.list_lable_fc&&t(".product-label-item").css("color",sessionStorage.list_lable_fc),t("#load_more_btn").unbind("click").click(function(){b.curPage<y&&!v&&(v=!0,b.curPage=b.curPage+1,t("#list_refresh_loading").removeClass("hide"),l())}),t("#sort_btn").unbind("click").click(function(i){i.stopPropagation(),t(this).children().eq(1).hasClass("icon-hao")?(n(),t(this).find(".pop-content").css("display","block"),t(this).children().eq(1).removeClass("icon-hao"),t(this).children().eq(1).addClass("icon--hao")):(t(this).find(".pop-content").css("display","none"),t(this).children().eq(1).addClass("icon-hao"),t(this).children().eq(1).removeClass("icon--hao"))}),t("#sort_btn .filter-attr-item").unbind("click").click(function(){Number(t(this).data().data)!==_&&(t("#sort_btn .filter-attr-item i").removeClass("icon-radio"),t("#sort_btn .filter-attr-item i").addClass("icon-RadioButton"),t(this).find("i").removeClass("icon-RadioButton"),t(this).find("i").addClass("icon-radio"),b.curPage=1,_=Number(t(this).data().data),l())})}function l(i){t("#list_loading").removeClass("hide");var i=c();s.dao.searchProducts({keyWord:k,currentPage:b.curPage,orderby:_,currencyId:s.util.getLocalCurrency(),filterObj:JSON.stringify({fiterAttr:i||[],tags:C||[]})},function(i){i.page?(t("#classify_name").html(k+"("+i.page.amount+")"),b.amount=i.page.amount,b.pageSize=i.page.pageSize,b.curPage=i.page.curPage,y=b.amount%b.pageSize==0?parseInt(b.amount/b.pageSize):parseInt(b.amount/b.pageSize)+1):t("#classify_name").html(k+"(0)");var e=i.products;e&&e.length>0?(p(e),f(e),h(),t("#item_list").show(),t(".empty-data").hide(),t(".page-function-wrap").show()):(t("#item_list").hide(),t(".empty-data").show(),t(".page-function-wrap").hide()),t("#left_filter_wrap .btn-wrap .confirm-btn").text(t.i18n.map.ConfirmBtn+"("+(b.amount?b.amount:0)+")"),t(".sort-wrap").removeClass("invisibility"),t(".loading-mask").addClass("hide"),t("footer").removeClass("invisibility"),v=!1},null,function(){t(".loading-mask").addClass("hide"),t("footer").removeClass("invisibility"),t("#list_loading").addClass("hide"),t("#list_refresh_loading").addClass("hide")})}function d(){s.dao.getFilterDataBySearchkey({keyWord:k},function(i){i&&(P=i,u(P.tags),P.fiterAttr&&P.fiterAttr.length>0&&(t("#filter_list").html(t("#filterItemTempl").tmpl(P.fiterAttr)),t("#filter_list .filter-item").unbind("click").click(function(i){i.stopPropagation(),t(this).children().eq(1).hasClass("icon-hao")?(n(),t(this).find(".pop-content").css("display","block"),t(this).children().eq(1).removeClass("icon-hao"),t(this).children().eq(1).addClass("icon--hao")):(t(this).find(".pop-content").css("display","none"),t(this).children().eq(1).addClass("icon-hao"),t(this).children().eq(1).removeClass("icon--hao"))}),t("#filter_list .filter-attr-item").unbind("click").click(function(i){i.stopPropagation(),t(this).find("i").hasClass("icon-fuxuankuang")?(t(this).find("i").removeClass("icon-fuxuankuang"),t(this).find("i").addClass("icon-fuxuankuang1")):(t(this).find("i").addClass("icon-fuxuankuang"),t(this).find("i").removeClass("icon-fuxuankuang1")),n(),b.curPage=1,l()})),t("#sort_btn .filter-attr-item i").eq("0").removeClass("icon-RadioButton"),t("#sort_btn .filter-attr-item i").eq("0").addClass("icon-radio"))})}function c(){var i=[];if(P)for(var e=0;e<P.fiterAttr.length;e++){for(var a={des:P.fiterAttr[e].des,type:P.fiterAttr[e].type,dmList:[]},s=0;s<P.fiterAttr[e].dmList.length;s++){var r=t("#"+P.fiterAttr[e].type+"_"+P.fiterAttr[e].dmList[s].optId);if(r.find("i").hasClass("icon-fuxuankuang1")){var n={optDes:P.fiterAttr[e].dmList[s].optDes,optId:P.fiterAttr[e].dmList[s].optId};a.dmList.push(n)}}a.dmList.length>0&&i.push(a)}return i}function u(i){i&&i.length>0&&(t("#label_list_wrap").html(t("#labelListTempl").tmpl(i)),t("#label_list_wrap").removeClass("hide"),t(".label-item").each(function(){for(var i=0;i<C.length;i++)t(this)[0].id==C[i]&&t(this).addClass("selected")}),t(".label-item").bind("click",function(i){var e=t(this)[0].id;if(t(this).hasClass("selected")){t(this).removeClass("selected");for(var a=0;a<C.length;a++)C[a].tagId==e&&C.splice(a,1)}else t(this).addClass("selected"),C.push({tagDes:t(this).text(),tagId:e});l()}))}function p(i){var e=s.util.getCurrencySymbol(s.util.getLocalCurrency()),a=s.util.getAdvSource().u;a||(a=s.util.getQueryString("u"));var r=s.util.encodeMenuType(s.util.getUvid()),n="";n=a?"?u="+a+"&uvid="+r:"?uvid="+r;for(var l=0;l<i.length;l++){for(var d=i[l],c=0;c<d.display_data.length;c++){var u=d.display_data[c];u.original_price=s.util.formatProductPrice(u.original_price,e),u.current_price=s.util.formatProductPrice(u.current_price,e),u.img_display=s.util.picUrl+u.img_display,u.color_img=s.util.picUrl+u.color_img,u.height=s.util.getImageHeight(),u.top=Number(s.util.getImageHeight())-50,u.href=s.util.formatProductName(d.product_name)+"-d-"+s.util.encodeMenuType(d.product_id)+"-"+s.util.encodeMenuType(u.color_id)+".html"+n,u.disCount&&sessionStorage.listOffSwitch&&"1"==sessionStorage.listOffSwitch?u.disCount=Number(u.disCount):u.disCount="",s.util.isMobile()?u.target="_blank":u.target="_self"}d.showColor=sessionStorage.img_block,d.statistic.saled&&(d.sold=t.i18n.map.soldedHint.replace("$number",d.statistic.saled))}if(s.util.isMobile()){1==b.curPage&&t("#item_list").html("");var p=t("#item_list").html();t("#item_list").html(t("#productItemTempl").tmpl(i)),p+=t("#item_list").html(),t("#item_list").html(p)}else t("#item_list").html(t("#productItemTempl").tmpl(i));t("#item_list #new_label").text(t.i18n.map.listNewLabel),o()}function h(){s.util.isMobile()?(t("#top_page").addClass("hide"),m(y)):(t("#top_page").removeClass("hide"),g(y))}function m(i){i>1&&b.curPage<i?(t("#load_more_btn").removeClass("hide"),t("#list_refresh_loading").removeClass("hide")):(t("#load_more_btn").addClass("hide"),t("#list_refresh_loading").addClass("hide"))}function g(i){t("#load_more_btn").addClass("hide"),t("#list_loading").addClass("hide"),t(function(){var e={bootstrapMajorVersion:1,currentPage:b.curPage,totalPages:i,shouldShowPage:!0,onPageClicked:function(i,a,s,r){b.curPage!==r&&(b.curPage=r,t("html").scrollTop(0),l(),e.currentPage=r,"top_page"==i.currentTarget.id?t("#page").bootstrapPaginator(e):t("#top_page").bootstrapPaginator(e))},onPageChanged:function(t,i,e){var a=window.location.href;a.indexOf("/#/")>-1&&(a=a.substring(0,a.indexOf("/#/"))),history.pushState("","",a+"/#/"+e)}};t("#page").bootstrapPaginator(e),t("#top_page").bootstrapPaginator(e)})}function f(i){t("#item_list .color-wrap img").bind("click",function(e){e.stopPropagation();var a=t(this).parent().parent().parent().parent().data().data,s=t(this).data().data,r=i[a].display_data[s];t(this).parent().parent().find("img").removeClass("selected"),t(this).addClass("selected");var n=r.href;t(this).parent().parent().parent().find("a:first").attr("href",n),t(this).parent().parent().parent().find("img:first").attr("src",r.img_display),t(this).parent().parent().parent().find(".product-name").html(r.pcName),t(this).parent().parent().parent().find(".product-ext-name").html(r.pcNameExt),t(this).parent().parent().parent().find(".price-wrap .goods-price").html(r.current_price),t(this).parent().parent().parent().find(".price-wrap .goods-del-price").html(r.original_price)})}s.util.getCookie("isFirst")||(s.util.setCookie("isFirst",0),t(".loading-mask").removeClass("hide")),s.initLoginStatus(),s.setLanguageCallback(function(){t("#breadcrumb_home").text(t.i18n.map.Home),t("#sort_method").html(t.i18n.map.SortRecommended)});var _=1,b={amount:0,curPage:1,pageSize:0},C=[],v=!1,y=0,P=null,k=s.util.getQueryString("keyword");k&&(t("#search_input").val(decodeURIComponent(k)),s.setCurrencyCodeCallback(function(){l(k),d()}));var S=window.location.href;S.indexOf("/#/")>-1&&(b.curPage=parseInt(S.substring(S.indexOf("/#/")+3)))});