"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common"],function(e,r,s,i,t){function a(){var r=_("#login_email_input","#login_error_email"),s=d("#login_pwd_input","#login_error_pwd");r&&s&&(e(".loading-mask").removeClass("hide"),e("#error_message").hide(),t.dao.login({email:e("#login_email_input").val().trim(),userPwd:e("#login_pwd_input").val()},function(e){console.log("login success"),n(e)},function(r){e("#error_message").html(r.msg),e("#error_message").show()},function(){e(".loading-mask").addClass("hide")}))}function o(){var r=_("#register_email_input","#register_error_email"),s=d("#register_pwd_input","#register_error_pwd");s=d("#register_confirm_pwd_input","#register_error_confirm_pwd"),e("#register_pwd_input").val()!==e("#register_confirm_pwd_input").val()&&(e("#error_message").html(e.i18n.map.PasswordNotMatch),e("#error_message").show(),s=!1);var i=c("#register_first_name_input","#register_error_first_name");if(!e("#agree_input")[0].checked)return void e("#register_error_agree").show();if(e("#register_error_agree").hide(),r&&s&&i){e(".loading-mask").removeClass("hide"),e("#error_message").hide();var a=e("input[type='radio'][name='gender']:checked").val();t.dao.register({inputParams:JSON.stringify({email:e("#register_email_input").val().trim(),userPwd:e("#register_pwd_input").val(),sex:a,firstName:e("#register_first_name_input").val().trim(),lastName:""})},function(e){n(e)},function(r){e("#error_message").html(r.msg),e("#error_message").show()},function(){e(".loading-mask").addClass("hide")})}}function n(e){if(sessionStorage.setItem("userId",e.userId),sessionStorage.setItem("userInfo",JSON.stringify(e)),sessionStorage.setItem("couponCode",""),localStorage.productList){for(var r=JSON.parse(localStorage.productList),s=0;s<r.length;s++)r[s].userId=e.userId;t.dao.merge2cart({inputParams:JSON.stringify(r)},function(e){localStorage.productList="",l()},function(e){alert(e.msg)})}else l()}function l(){var e={currencyId:t.util.getLocalCurrency(),userId:t.util.getUserId(),cart:[],applyCpNo:t.util.getCouponCode()};t.dao.shoppingCart({inputParams:JSON.stringify(e)},function(e){e.cart&&e.cart.length>0?window.location.href="../../../shopping_cart.html":window.location.href="../../../my_account.html"})}function _(r,s){var i=t.util.checkEmail(e(r).val().trim());return console.log(i),1!==i?(e(r).removeClass("has-success"),e(r).addClass("has-error"),e(s).show(),!1):(e(r).removeClass("has-error"),e(r).addClass("has-success"),e(s).hide(),!0)}function d(r,s){var i=t.util.checkPassword(e(r).val());return console.log(i),1!==i?(e(r).removeClass("has-success"),e(r).addClass("has-error"),e(s).show(),!1):(e(r).removeClass("has-error"),e(r).addClass("has-success"),e(s).hide(),!0)}function c(r,s){var i=t.util.checkNull(e(r).val());return console.log(i),1!==i?(e(r).removeClass("has-success"),e(r).addClass("has-error"),e(s).show(),!1):(e(r).removeClass("has-error"),e(r).addClass("has-success"),e(s).hide(),!0)}var h=t.util.getQueryString("tab");h&&2==h&&(e("#register_tab").addClass("selected"),e("#login_tab").removeClass("selected"),e("#login_wrap").addClass("hide"),e("#register_wrap").removeClass("hide")),function(){e("#login_tab").click(function(){e("#login_tab").addClass("selected"),e("#register_tab").removeClass("selected"),e("#login_wrap").removeClass("hide"),e("#register_wrap").addClass("hide")}),e("#register_tab").click(function(){e("#register_tab").addClass("selected"),e("#login_tab").removeClass("selected"),e("#login_wrap").addClass("hide"),e("#register_wrap").removeClass("hide")}),e("#agree_input").change(function(){e(this)[0].checked?e("#register_error_agree").hide():e("#register_error_agree").show()}),e("#commit_login_btn").click(function(){a()}),e("#register_btn").click(function(){o()}),e("#login_email_input, #login_pwd_input").bind("keydown",function(e){"13"==e.keyCode&&a()}),e("#register_email_input, #register_pwd_input, #register_confirm_pwd_input").bind("keydown",function(e){"13"==e.keyCode&&o()})}(),function(){if(sessionStorage.next_advert_txt){var r=JSON.parse(sessionStorage.next_advert_txt);r&&r.length>1&&e("#register_adv_text_1").text(r[1])}}(),function(){e("#login_email_input").blur(function(){var r=t.util.checkEmail(e(this).val().trim());console.log(r),0==r?(e(this).removeClass("has-success"),e(this).addClass("has-error"),e("#login_error_email").show()):-1==r?(e(this).removeClass("has-success"),e(this).addClass("has-error"),e("#login_error_email").show()):1==r&&(e(this).removeClass("has-error"),e(this).addClass("has-success"),e("#login_error_email").hide())}),e("#login_pwd_input").blur(function(){var r=t.util.checkPassword(e(this).val());console.log(r),0==r?(e(this).removeClass("has-success"),e(this).addClass("has-error"),e("#login_error_pwd").show()):-1==r?(e(this).removeClass("has-success"),e(this).addClass("has-error"),e("#login_error_pwd").show()):1==r&&(e(this).removeClass("has-error"),e(this).addClass("has-success"),e("#login_error_pwd").hide())})}(),function(){e("#register_email_input").blur(function(){var r=t.util.checkEmail(e(this).val().trim());console.log(r),0==r?(e(this).removeClass("has-success"),e(this).addClass("has-error"),"register_email_input"==e(this)[0].id?e("#register_error_email").show():"register_confirm_email_input"==e(this)[0].id&&e("#register_error_confirm_email").show()):-1==r?(e(this).removeClass("has-success"),e(this).addClass("has-error"),"register_email_input"==e(this)[0].id?e("#register_error_email").show():"register_confirm_email_input"==e(this)[0].id&&e("#register_error_confirm_email").show()):1==r&&(e(this).removeClass("has-error"),e(this).addClass("has-success"),"register_email_input"==e(this)[0].id?e("#register_error_email").hide():"register_confirm_email_input"==e(this)[0].id&&e("#register_error_confirm_email").hide())}),e("#register_pwd_input, #register_confirm_pwd_input").blur(function(){var r=t.util.checkPassword(e(this).val());console.log(r),0==r?(e(this).removeClass("has-success"),e(this).addClass("has-error"),"register_pwd_input"==e(this)[0].id?e("#register_error_pwd").show():"register_confirm_pwd_input"==e(this)[0].id&&e("#register_error_confirm_pwd").show()):-1==r?(e(this).removeClass("has-success"),e(this).addClass("has-error"),"register_pwd_input"==e(this)[0].id?e("#register_error_pwd").show():"register_confirm_pwd_input"==e(this)[0].id&&e("#register_error_confirm_pwd").show()):1==r&&(e(this).removeClass("has-error"),e(this).addClass("has-success"),"register_pwd_input"==e(this)[0].id?e("#register_error_pwd").hide():"register_confirm_pwd_input"==e(this)[0].id&&e("#register_error_confirm_pwd").hide())}),e("#register_first_name_input").blur(function(){e("#register_first_name_input").val()?(e(this).removeClass("has-error"),e(this).addClass("has-success"),e("#register_error_first_name").hide()):(e(this).removeClass("has-success"),e(this).addClass("has-error"),e("#register_error_first_name").show())}),e("#register_last_name_input").blur(function(){e("#register_last_name_input").val()?(e(this).removeClass("has-error"),e(this).addClass("has-success"),e("#register_error_last_name").hide()):(e(this).removeClass("has-success"),e(this).addClass("has-error"),e("#register_error_last_name").show())})}(),localStorage&&localStorage.selectedLanguage&&e("#policy_url").attr("href",JSON.parse(localStorage.selectedLanguage).langCode+"/privacy.html"),t.setLanguageCallback(function(r){e("#policy_url").attr("href",r+"/privacy.html")})});